<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>HN Test App</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <link rel="shortcut icon" id="dynamic-favicon" href="https://res.cloudinary.com/huht2rslk/image/upload/v1754949064/wolf_favicon_cdvvtz.png">
</head>
<body class="bg-gradient-to-br from-yellow-600 via-purple-800 to-slate-900 min-h-screen">
  <div id="app" class="max-w-4xl mx-auto p-6 text-slate-900">
    <h1 class="text-2xl font-bold mb-4 text-white drop-shadow">Hacker News Test Application</h1>

    <!-- Auth notice (no creds UI because HN often blocks automation with validation) -->
    <div class="mb-6 rounded-2xl shadow p-4 border bg-white/90 backdrop-blur">
      <h2 class="text-lg font-medium mb-2">Authentication tests</h2>
      <p class="text-sm text-gray-700">
        HN login is frequently protected by a manual “Validation required” step, so this runner skips auth tests by default.
        The rest of the suite (content, tabs, links, performance, etc.) is fully automated and cross-browser.
      </p>
      <p class="text-xs text-gray-500 mt-2">
        If you really need to probe credentials locally, run the CLI check:
        <code>HN_USER=&lt;user&gt; HN_PASS=&lt;pass&gt; node auth-check.js</code>.
        Expect it to report “validation required” on many networks.
      </p>
    </div>

    <!-- Toolbar -->
    <div class="mb-4 flex flex-wrap gap-2">
      <button @click="runAll"
        class="px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600">
        Run All Tests
      </button>
      <button @click="resetAll" class="px-3 py-2 bg-gray-700 text-white rounded hover:bg-gray-800">Reset</button>
    </div>

    <!-- Test Cards -->
    <div v-for="t in tests" :key="t.name" class="border p-3 rounded mb-2 bg-white/95 backdrop-blur">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-2">
          <div v-if="t.status==='running'" class="animate-spin h-4 w-4 border-2 border-t-transparent rounded-full"></div>
          <span class="font-medium">{{ t.name }}</span>
          <span v-if="t.status==='pass'" class="text-emerald-700 text-sm">— passed</span>
          <span v-else-if="t.status==='fail'" class="text-red-600 text-sm">— failed</span>
          <span v-else-if="t.status==='error'" class="text-red-600 text-sm">— error</span>
          <span v-else-if="t.status==='aborted'" class="text-gray-500 text-sm">— aborted</span>
          <span v-else-if="t.statusText" class="text-sm text-gray-600">— {{ t.statusText }}</span>
        </div>

        <div class="flex items-center gap-2">
          <!-- Run / Abort toggle -->
          <button
            v-if="t.status !== 'running'"
            @click="runTest(t.name)"
            class="px-3 py-1.5 rounded bg-orange-500 text-white hover:bg-blue-700"
          >Run</button>
          <button
            v-else
            @click="abortTest(t.name)"
            class="px-3 py-1.5 rounded bg-red-600 text-white hover:bg-red-700"
          >Abort</button>

          <!-- Logs toggle -->
          <button
            @click="t.showLogs = !t.showLogs"
            class="px-3 py-1.5 rounded bg-gray-200 hover:bg-gray-300"
          >{{ t.showLogs ? 'Hide' : 'Show' }} Logs</button>
        </div>
      </div>

      <pre v-if="t.showLogs"
           class="mt-2 bg-black text-slate-50 p-3 rounded h-60 overflow-auto whitespace-pre-wrap">{{ t.logs.join('\n') }}</pre>
    </div>
  </div>

  <script defer src="/app.js"></script>
</body>
</html>
